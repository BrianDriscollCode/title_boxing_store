"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _Utils = _interopRequireDefault(require("./Utils"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class App {
  /**
   * Provides access to the `applications` version 2 endpoint.
   */
  static get PATH() {
    return "/v2/applications";
  }
  /**
   * @param {Credentials} credentials
   *    credentials to be used when interacting with the API.
   * @param {Object} options
   *    Addition App options.
   */


  constructor(credentials) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    this.creds = credentials;
    this.options = options;
  }

  _convertMethodSignature(name, type, answerUrl, eventUrl, options) {
    var capability = {};

    switch (type) {
      case "voice":
        capability = {
          voice: {
            webhooks: {
              answer_url: {
                address: answerUrl,
                http_method: "GET"
              },
              event_url: {
                address: eventUrl,
                http_method: "POST"
              }
            }
          }
        };
        break;

      case "messages":
        capability = {
          messages: {
            webhooks: {
              inbound_url: {
                address: options.inbound_url,
                http_method: "POST"
              },
              status_url: {
                address: options.status_url,
                http_method: "POST"
              }
            }
          }
        };
        break;

      case "rtc":
        capability = {
          rtc: {
            webhooks: {
              event_url: {
                address: eventUrl,
                http_method: "POST"
              }
            }
          }
        };
        break;
    }

    return {
      name: name,
      capabilities: capability
    };
  }

  _convertApplicationResponse(application) {
    for (var capability in application.capabilities) {
      application[capability] = {
        webhooks: []
      };

      for (var webhook in application.capabilities[capability].webhooks) {
        application[capability].webhooks.push({
          endpoint_type: webhook,
          endpoint: application.capabilities[capability].webhooks[webhook].address,
          http_method: application.capabilities[capability].webhooks[webhook].http_method
        });
      }
    }

    delete application.capabilities;
    return application;
  }

  _convertApplicationListResponse(applicationResponseHandler) {
    return response => {
      response.count = response.total_items;
      response.page_index = response.page;

      for (var i in response._embedded.applications) {
        response._embedded.applications[i] = applicationResponseHandler(response._embedded.applications[i]);
      }

      return response;
    };
  }
  /**
   * TODO: document
   */


  create(name, type, answerUrl, eventUrl, options, callback) {
    var params = {};
    var responseParser = null;

    if (arguments.length > 2) {
      params = JSON.stringify(this._convertMethodSignature(name, type, answerUrl, eventUrl, options));
      responseParser = this._convertApplicationResponse;
    } else {
      params = JSON.stringify(name);
      callback = type;
    }

    var authorization = "".concat(this.creds.apiKey, ":").concat(this.creds.apiSecret);
    var config = {
      host: this.options.apiHost || "api.nexmo.com",
      path: App.PATH,
      method: "POST",
      body: params,
      headers: {
        "Content-Type": "application/json",
        Authorization: "Basic ".concat(Buffer.from(authorization).toString("base64"))
      }
    };
    this.options.httpClient.request(config, callback, callback, false, responseParser);
  }
  /**
   * TODO: document
   */


  get(params, callback) {
    var v2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var authorization = "".concat(this.creds.apiKey, ":").concat(this.creds.apiSecret);
    var responseParser = null;

    if (typeof params !== "object") {
      responseParser = this._convertApplicationResponse;
    } else {
      responseParser = this._convertApplicationListResponse(this._convertApplicationResponse);
    }

    if (v2) {
      responseParser = null;
    }

    var config = {
      host: this.options.apiHost || "api.nexmo.com",
      path: _Utils.default.createPathWithQuery(App.PATH, params),
      method: "GET",
      body: undefined,
      headers: {
        "Content-Type": "application/json",
        Authorization: "Basic ".concat(Buffer.from(authorization).toString("base64"))
      }
    };
    this.options.httpClient.request(config, callback, callback, false, responseParser);
  }
  /**
   * TODO: document
   */


  update(appId, name, type, answerUrl, eventUrl, options, callback) {
    var params = {};
    var responseParser = null;

    if (arguments.length > 3) {
      params = JSON.stringify(this._convertMethodSignature(name, type, answerUrl, eventUrl, options));
      responseParser = this._convertApplicationResponse;
    } else {
      params = JSON.stringify(name);
      callback = type;
    }

    var authorization = "".concat(this.creds.apiKey, ":").concat(this.creds.apiSecret);
    var config = {
      host: this.options.apiHost || "api.nexmo.com",
      path: "".concat(App.PATH, "/").concat(appId),
      method: "PUT",
      body: params,
      headers: {
        "Content-Type": "application/json",
        Authorization: "Basic ".concat(Buffer.from(authorization).toString("base64"))
      }
    };
    this.options.httpClient.request(config, callback, callback, false, responseParser);
  }
  /**
   * TODO: document
   */


  delete(appId, callback) {
    var authorization = "".concat(this.creds.apiKey, ":").concat(this.creds.apiSecret);
    var config = {
      host: this.options.apiHost || "api.nexmo.com",
      path: "".concat(App.PATH, "/").concat(appId),
      method: "DELETE",
      body: "{}",
      headers: {
        "Content-Type": "application/json",
        Authorization: "Basic ".concat(Buffer.from(authorization).toString("base64"))
      }
    };
    this.options.httpClient.request(config, callback);
  }

}

var _default = App;
exports.default = _default;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcHAiLCJQQVRIIiwiY29uc3RydWN0b3IiLCJjcmVkZW50aWFscyIsIm9wdGlvbnMiLCJjcmVkcyIsIl9jb252ZXJ0TWV0aG9kU2lnbmF0dXJlIiwibmFtZSIsInR5cGUiLCJhbnN3ZXJVcmwiLCJldmVudFVybCIsImNhcGFiaWxpdHkiLCJ2b2ljZSIsIndlYmhvb2tzIiwiYW5zd2VyX3VybCIsImFkZHJlc3MiLCJodHRwX21ldGhvZCIsImV2ZW50X3VybCIsIm1lc3NhZ2VzIiwiaW5ib3VuZF91cmwiLCJzdGF0dXNfdXJsIiwicnRjIiwiY2FwYWJpbGl0aWVzIiwiX2NvbnZlcnRBcHBsaWNhdGlvblJlc3BvbnNlIiwiYXBwbGljYXRpb24iLCJ3ZWJob29rIiwicHVzaCIsImVuZHBvaW50X3R5cGUiLCJlbmRwb2ludCIsIl9jb252ZXJ0QXBwbGljYXRpb25MaXN0UmVzcG9uc2UiLCJhcHBsaWNhdGlvblJlc3BvbnNlSGFuZGxlciIsInJlc3BvbnNlIiwiY291bnQiLCJ0b3RhbF9pdGVtcyIsInBhZ2VfaW5kZXgiLCJwYWdlIiwiaSIsIl9lbWJlZGRlZCIsImFwcGxpY2F0aW9ucyIsImNyZWF0ZSIsImNhbGxiYWNrIiwicGFyYW1zIiwicmVzcG9uc2VQYXJzZXIiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJKU09OIiwic3RyaW5naWZ5IiwiYXV0aG9yaXphdGlvbiIsImFwaUtleSIsImFwaVNlY3JldCIsImNvbmZpZyIsImhvc3QiLCJhcGlIb3N0IiwicGF0aCIsIm1ldGhvZCIsImJvZHkiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsImh0dHBDbGllbnQiLCJyZXF1ZXN0IiwiZ2V0IiwidjIiLCJVdGlscyIsImNyZWF0ZVBhdGhXaXRoUXVlcnkiLCJ1bmRlZmluZWQiLCJ1cGRhdGUiLCJhcHBJZCIsImRlbGV0ZSJdLCJzb3VyY2VzIjpbIi4uL3NyYy9BcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCBVdGlscyBmcm9tIFwiLi9VdGlsc1wiO1xuXG5jbGFzcyBBcHAge1xuICAvKipcbiAgICogUHJvdmlkZXMgYWNjZXNzIHRvIHRoZSBgYXBwbGljYXRpb25zYCB2ZXJzaW9uIDIgZW5kcG9pbnQuXG4gICAqL1xuICBzdGF0aWMgZ2V0IFBBVEgoKSB7XG4gICAgcmV0dXJuIFwiL3YyL2FwcGxpY2F0aW9uc1wiO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0ge0NyZWRlbnRpYWxzfSBjcmVkZW50aWFsc1xuICAgKiAgICBjcmVkZW50aWFscyB0byBiZSB1c2VkIHdoZW4gaW50ZXJhY3Rpbmcgd2l0aCB0aGUgQVBJLlxuICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICAgKiAgICBBZGRpdGlvbiBBcHAgb3B0aW9ucy5cbiAgICovXG4gIGNvbnN0cnVjdG9yKGNyZWRlbnRpYWxzLCBvcHRpb25zID0ge30pIHtcbiAgICB0aGlzLmNyZWRzID0gY3JlZGVudGlhbHM7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgfVxuXG4gIF9jb252ZXJ0TWV0aG9kU2lnbmF0dXJlKG5hbWUsIHR5cGUsIGFuc3dlclVybCwgZXZlbnRVcmwsIG9wdGlvbnMpIHtcbiAgICBsZXQgY2FwYWJpbGl0eSA9IHt9O1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSBcInZvaWNlXCI6XG4gICAgICAgIGNhcGFiaWxpdHkgPSB7XG4gICAgICAgICAgdm9pY2U6IHtcbiAgICAgICAgICAgIHdlYmhvb2tzOiB7XG4gICAgICAgICAgICAgIGFuc3dlcl91cmw6IHtcbiAgICAgICAgICAgICAgICBhZGRyZXNzOiBhbnN3ZXJVcmwsXG4gICAgICAgICAgICAgICAgaHR0cF9tZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGV2ZW50X3VybDoge1xuICAgICAgICAgICAgICAgIGFkZHJlc3M6IGV2ZW50VXJsLFxuICAgICAgICAgICAgICAgIGh0dHBfbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwibWVzc2FnZXNcIjpcbiAgICAgICAgY2FwYWJpbGl0eSA9IHtcbiAgICAgICAgICBtZXNzYWdlczoge1xuICAgICAgICAgICAgd2ViaG9va3M6IHtcbiAgICAgICAgICAgICAgaW5ib3VuZF91cmw6IHtcbiAgICAgICAgICAgICAgICBhZGRyZXNzOiBvcHRpb25zLmluYm91bmRfdXJsLFxuICAgICAgICAgICAgICAgIGh0dHBfbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc3RhdHVzX3VybDoge1xuICAgICAgICAgICAgICAgIGFkZHJlc3M6IG9wdGlvbnMuc3RhdHVzX3VybCxcbiAgICAgICAgICAgICAgICBodHRwX21ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInJ0Y1wiOlxuICAgICAgICBjYXBhYmlsaXR5ID0ge1xuICAgICAgICAgIHJ0Yzoge1xuICAgICAgICAgICAgd2ViaG9va3M6IHtcbiAgICAgICAgICAgICAgZXZlbnRfdXJsOiB7XG4gICAgICAgICAgICAgICAgYWRkcmVzczogZXZlbnRVcmwsXG4gICAgICAgICAgICAgICAgaHR0cF9tZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogbmFtZSxcbiAgICAgIGNhcGFiaWxpdGllczogY2FwYWJpbGl0eSxcbiAgICB9O1xuICB9XG5cbiAgX2NvbnZlcnRBcHBsaWNhdGlvblJlc3BvbnNlKGFwcGxpY2F0aW9uKSB7XG4gICAgZm9yIChsZXQgY2FwYWJpbGl0eSBpbiBhcHBsaWNhdGlvbi5jYXBhYmlsaXRpZXMpIHtcbiAgICAgIGFwcGxpY2F0aW9uW2NhcGFiaWxpdHldID0ge1xuICAgICAgICB3ZWJob29rczogW10sXG4gICAgICB9O1xuICAgICAgZm9yIChsZXQgd2ViaG9vayBpbiBhcHBsaWNhdGlvbi5jYXBhYmlsaXRpZXNbY2FwYWJpbGl0eV0ud2ViaG9va3MpIHtcbiAgICAgICAgYXBwbGljYXRpb25bY2FwYWJpbGl0eV0ud2ViaG9va3MucHVzaCh7XG4gICAgICAgICAgZW5kcG9pbnRfdHlwZTogd2ViaG9vayxcbiAgICAgICAgICBlbmRwb2ludDpcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uLmNhcGFiaWxpdGllc1tjYXBhYmlsaXR5XS53ZWJob29rc1t3ZWJob29rXS5hZGRyZXNzLFxuICAgICAgICAgIGh0dHBfbWV0aG9kOlxuICAgICAgICAgICAgYXBwbGljYXRpb24uY2FwYWJpbGl0aWVzW2NhcGFiaWxpdHldLndlYmhvb2tzW3dlYmhvb2tdLmh0dHBfbWV0aG9kLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBkZWxldGUgYXBwbGljYXRpb24uY2FwYWJpbGl0aWVzO1xuICAgIHJldHVybiBhcHBsaWNhdGlvbjtcbiAgfVxuXG4gIF9jb252ZXJ0QXBwbGljYXRpb25MaXN0UmVzcG9uc2UoYXBwbGljYXRpb25SZXNwb25zZUhhbmRsZXIpIHtcbiAgICByZXR1cm4gKHJlc3BvbnNlKSA9PiB7XG4gICAgICByZXNwb25zZS5jb3VudCA9IHJlc3BvbnNlLnRvdGFsX2l0ZW1zO1xuICAgICAgcmVzcG9uc2UucGFnZV9pbmRleCA9IHJlc3BvbnNlLnBhZ2U7XG4gICAgICBmb3IgKGxldCBpIGluIHJlc3BvbnNlLl9lbWJlZGRlZC5hcHBsaWNhdGlvbnMpIHtcbiAgICAgICAgcmVzcG9uc2UuX2VtYmVkZGVkLmFwcGxpY2F0aW9uc1tpXSA9IGFwcGxpY2F0aW9uUmVzcG9uc2VIYW5kbGVyKFxuICAgICAgICAgIHJlc3BvbnNlLl9lbWJlZGRlZC5hcHBsaWNhdGlvbnNbaV1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogVE9ETzogZG9jdW1lbnRcbiAgICovXG4gIGNyZWF0ZShuYW1lLCB0eXBlLCBhbnN3ZXJVcmwsIGV2ZW50VXJsLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIGxldCBwYXJhbXMgPSB7fTtcbiAgICBsZXQgcmVzcG9uc2VQYXJzZXIgPSBudWxsO1xuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAyKSB7XG4gICAgICBwYXJhbXMgPSBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgdGhpcy5fY29udmVydE1ldGhvZFNpZ25hdHVyZShuYW1lLCB0eXBlLCBhbnN3ZXJVcmwsIGV2ZW50VXJsLCBvcHRpb25zKVxuICAgICAgKTtcbiAgICAgIHJlc3BvbnNlUGFyc2VyID0gdGhpcy5fY29udmVydEFwcGxpY2F0aW9uUmVzcG9uc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBhcmFtcyA9IEpTT04uc3RyaW5naWZ5KG5hbWUpO1xuICAgICAgY2FsbGJhY2sgPSB0eXBlO1xuICAgIH1cblxuICAgIGNvbnN0IGF1dGhvcml6YXRpb24gPSBgJHt0aGlzLmNyZWRzLmFwaUtleX06JHt0aGlzLmNyZWRzLmFwaVNlY3JldH1gO1xuXG4gICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgIGhvc3Q6IHRoaXMub3B0aW9ucy5hcGlIb3N0IHx8IFwiYXBpLm5leG1vLmNvbVwiLFxuICAgICAgcGF0aDogQXBwLlBBVEgsXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogcGFyYW1zLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7QnVmZmVyLmZyb20oYXV0aG9yaXphdGlvbikudG9TdHJpbmcoXCJiYXNlNjRcIil9YCxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRoaXMub3B0aW9ucy5odHRwQ2xpZW50LnJlcXVlc3QoXG4gICAgICBjb25maWcsXG4gICAgICBjYWxsYmFjayxcbiAgICAgIGNhbGxiYWNrLFxuICAgICAgZmFsc2UsXG4gICAgICByZXNwb25zZVBhcnNlclxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETzogZG9jdW1lbnRcbiAgICovXG4gIGdldChwYXJhbXMsIGNhbGxiYWNrLCB2MiA9IGZhbHNlKSB7XG4gICAgY29uc3QgYXV0aG9yaXphdGlvbiA9IGAke3RoaXMuY3JlZHMuYXBpS2V5fToke3RoaXMuY3JlZHMuYXBpU2VjcmV0fWA7XG4gICAgbGV0IHJlc3BvbnNlUGFyc2VyID0gbnVsbDtcblxuICAgIGlmICh0eXBlb2YgcGFyYW1zICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICByZXNwb25zZVBhcnNlciA9IHRoaXMuX2NvbnZlcnRBcHBsaWNhdGlvblJlc3BvbnNlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXNwb25zZVBhcnNlciA9IHRoaXMuX2NvbnZlcnRBcHBsaWNhdGlvbkxpc3RSZXNwb25zZShcbiAgICAgICAgdGhpcy5fY29udmVydEFwcGxpY2F0aW9uUmVzcG9uc2VcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKHYyKSB7XG4gICAgICByZXNwb25zZVBhcnNlciA9IG51bGw7XG4gICAgfVxuXG4gICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgIGhvc3Q6IHRoaXMub3B0aW9ucy5hcGlIb3N0IHx8IFwiYXBpLm5leG1vLmNvbVwiLFxuICAgICAgcGF0aDogVXRpbHMuY3JlYXRlUGF0aFdpdGhRdWVyeShBcHAuUEFUSCwgcGFyYW1zKSxcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGJvZHk6IHVuZGVmaW5lZCxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCYXNpYyAke0J1ZmZlci5mcm9tKGF1dGhvcml6YXRpb24pLnRvU3RyaW5nKFwiYmFzZTY0XCIpfWAsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICB0aGlzLm9wdGlvbnMuaHR0cENsaWVudC5yZXF1ZXN0KFxuICAgICAgY29uZmlnLFxuICAgICAgY2FsbGJhY2ssXG4gICAgICBjYWxsYmFjayxcbiAgICAgIGZhbHNlLFxuICAgICAgcmVzcG9uc2VQYXJzZXJcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE86IGRvY3VtZW50XG4gICAqL1xuICB1cGRhdGUoYXBwSWQsIG5hbWUsIHR5cGUsIGFuc3dlclVybCwgZXZlbnRVcmwsIG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgbGV0IHBhcmFtcyA9IHt9O1xuICAgIGxldCByZXNwb25zZVBhcnNlciA9IG51bGw7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAzKSB7XG4gICAgICBwYXJhbXMgPSBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgdGhpcy5fY29udmVydE1ldGhvZFNpZ25hdHVyZShuYW1lLCB0eXBlLCBhbnN3ZXJVcmwsIGV2ZW50VXJsLCBvcHRpb25zKVxuICAgICAgKTtcbiAgICAgIHJlc3BvbnNlUGFyc2VyID0gdGhpcy5fY29udmVydEFwcGxpY2F0aW9uUmVzcG9uc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBhcmFtcyA9IEpTT04uc3RyaW5naWZ5KG5hbWUpO1xuICAgICAgY2FsbGJhY2sgPSB0eXBlO1xuICAgIH1cblxuICAgIGNvbnN0IGF1dGhvcml6YXRpb24gPSBgJHt0aGlzLmNyZWRzLmFwaUtleX06JHt0aGlzLmNyZWRzLmFwaVNlY3JldH1gO1xuXG4gICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgIGhvc3Q6IHRoaXMub3B0aW9ucy5hcGlIb3N0IHx8IFwiYXBpLm5leG1vLmNvbVwiLFxuICAgICAgcGF0aDogYCR7QXBwLlBBVEh9LyR7YXBwSWR9YCxcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGJvZHk6IHBhcmFtcyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCYXNpYyAke0J1ZmZlci5mcm9tKGF1dGhvcml6YXRpb24pLnRvU3RyaW5nKFwiYmFzZTY0XCIpfWAsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICB0aGlzLm9wdGlvbnMuaHR0cENsaWVudC5yZXF1ZXN0KFxuICAgICAgY29uZmlnLFxuICAgICAgY2FsbGJhY2ssXG4gICAgICBjYWxsYmFjayxcbiAgICAgIGZhbHNlLFxuICAgICAgcmVzcG9uc2VQYXJzZXJcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE86IGRvY3VtZW50XG4gICAqL1xuICBkZWxldGUoYXBwSWQsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgYXV0aG9yaXphdGlvbiA9IGAke3RoaXMuY3JlZHMuYXBpS2V5fToke3RoaXMuY3JlZHMuYXBpU2VjcmV0fWA7XG5cbiAgICB2YXIgY29uZmlnID0ge1xuICAgICAgaG9zdDogdGhpcy5vcHRpb25zLmFwaUhvc3QgfHwgXCJhcGkubmV4bW8uY29tXCIsXG4gICAgICBwYXRoOiBgJHtBcHAuUEFUSH0vJHthcHBJZH1gLFxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgYm9keTogXCJ7fVwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7QnVmZmVyLmZyb20oYXV0aG9yaXphdGlvbikudG9TdHJpbmcoXCJiYXNlNjRcIil9YCxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRoaXMub3B0aW9ucy5odHRwQ2xpZW50LnJlcXVlc3QoY29u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