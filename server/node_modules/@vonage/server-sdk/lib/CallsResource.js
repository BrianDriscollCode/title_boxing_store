"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _querystring = _interopRequireDefault(require("querystring"));

var _StreamResource = _interopRequireDefault(require("./StreamResource"));

var _TalkResource = _interopRequireDefault(require("./TalkResource"));

var _DtmfResource = _interopRequireDefault(require("./DtmfResource"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Provides access to the `calls` resource.
 */
class CallsResource {
  /**
   * The path to the `calls` resource.
   */
  static get PATH() {
    return "/v1/calls";
  }
  /**
   * Creates a new CallsResource.
   *
   * @param {Credentials} creds - Credentials used when interacting with the Vonage API.
   * @param {Object} options - additional options for the class.
   */


  constructor(creds, options) {
    this.creds = creds;
    this.options = options;
    /**
     * @type StreamController
     */

    this.stream = new _StreamResource.default(this.creds, this.options);
    /**
     * @type TalkResource
     */

    this.talk = new _TalkResource.default(this.creds, this.options);
    /**
     * @type DtmfResource
     */

    this.dtmf = new _DtmfResource.default(this.creds, this.options);
  }
  /**
   * Create a new call.
   *
   * @param {Object} params - Parameters used when creating the call. See https://developer.nexmo.com/api/voice#create-an-outbound-call for more information.
   * @param {function} callback - function to be called when the request completes.
   */


  create(params, callback) {
    params = JSON.stringify(params);
    var config = {
      host: this.options.apiHost || "api.nexmo.com",
      path: CallsResource.PATH,
      method: "POST",
      body: params,
      headers: {
        "Content-Type": "application/json",
        "Content-Length": Buffer.byteLength(params),
        Authorization: "Bearer ".concat(this.creds.generateJwt())
      }
    };
    this.options.httpClient.request(config, callback);
  }
  /**
   * Get an existing call.
   *
   * @param {string|object} query - The unique identifier for the call to retrieve
   *               or a set of filter parameters for the query. For more information
   *               see https://docs.nexmo.com/voice/voice-api/api-reference#call_retrieve
   * @param {function} callback - function to be called when the request completes.
   */


  get(query, callback) {
    if (!query) {
      throw new Error('"query" is a required parameter');
    }

    var pathExt = "";

    if (typeof query === "string") {
      // single call Id
      pathExt = "/".concat(query);
    } else if (typeof query === "object" && Object.keys(query).length > 0) {
      // filter
      pathExt = "?".concat(_querystring.default.stringify(query));
    }

    var config = {
      host: this.options.apiHost || "api.nexmo.com",
      path: "".concat(CallsResource.PATH).concat(pathExt),
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        Authorization: "Bearer ".concat(this.creds.generateJwt())
      }
    };
    this.options.httpClient.request(config, callback);
  }
  /**
   * Update an existing call.
   *
   * @param {string} [callId] - The unique identifier for the call to update.
   * @param {Object} params - Parameters used when updating the call. See https://developer.nexmo.com/api/voice#modify-an-existing-call for more information.
   * @param {function} callback - function to be called when the request completes.
   */


  update(callId, params, callback) {
    params = JSON.stringify(params);
    var config = {
      host: this.options.apiHost || "api.nexmo.com",
      path: "".concat(CallsResource.PATH, "/").concat(callId),
      method: "PUT",
      body: params,
      headers: {
        "Content-Type": "application/json",
        "Content-Length": Buffer.byteLength(params),
        Authorization: "Bearer ".concat(this.creds.generateJwt())
      }
    };
    this.options.httpClient.request(config, callback);
  }

}

var _default = CallsResource;
exports.default = _default;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDYWxsc1Jlc291cmNlIiwiUEFUSCIsImNvbnN0cnVjdG9yIiwiY3JlZHMiLCJvcHRpb25zIiwic3RyZWFtIiwiU3RyZWFtUmVzb3VyY2UiLCJ0YWxrIiwiVGFsa1Jlc291cmNlIiwiZHRtZiIsIkR0bWZSZXNvdXJjZSIsImNyZWF0ZSIsInBhcmFtcyIsImNhbGxiYWNrIiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbmZpZyIsImhvc3QiLCJhcGlIb3N0IiwicGF0aCIsIm1ldGhvZCIsImJvZHkiLCJoZWFkZXJzIiwiQnVmZmVyIiwiYnl0ZUxlbmd0aCIsIkF1dGhvcml6YXRpb24iLCJnZW5lcmF0ZUp3dCIsImh0dHBDbGllbnQiLCJyZXF1ZXN0IiwiZ2V0IiwicXVlcnkiLCJFcnJvciIsInBhdGhFeHQiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwicXVlcnlzdHJpbmciLCJ1cGRhdGUiLCJjYWxsSWQiXSwic291cmNlcyI6WyIuLi9zcmMvQ2FsbHNSZXNvdXJjZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcXVlcnlzdHJpbmcgZnJvbSBcInF1ZXJ5c3RyaW5nXCI7XG5cbmltcG9ydCBTdHJlYW1SZXNvdXJjZSBmcm9tIFwiLi9TdHJlYW1SZXNvdXJjZVwiO1xuaW1wb3J0IFRhbGtSZXNvdXJjZSBmcm9tIFwiLi9UYWxrUmVzb3VyY2VcIjtcbmltcG9ydCBEdG1mUmVzb3VyY2UgZnJvbSBcIi4vRHRtZlJlc291cmNlXCI7XG5cbi8qKlxuICogUHJvdmlkZXMgYWNjZXNzIHRvIHRoZSBgY2FsbHNgIHJlc291cmNlLlxuICovXG5jbGFzcyBDYWxsc1Jlc291cmNlIHtcbiAgLyoqXG4gICAqIFRoZSBwYXRoIHRvIHRoZSBgY2FsbHNgIHJlc291cmNlLlxuICAgKi9cbiAgc3RhdGljIGdldCBQQVRIKCkge1xuICAgIHJldHVybiBcIi92MS9jYWxsc1wiO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBuZXcgQ2FsbHNSZXNvdXJjZS5cbiAgICpcbiAgICogQHBhcmFtIHtDcmVkZW50aWFsc30gY3JlZHMgLSBDcmVkZW50aWFscyB1c2VkIHdoZW4gaW50ZXJhY3Rpbmcgd2l0aCB0aGUgVm9uYWdlIEFQSS5cbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgLSBhZGRpdGlvbmFsIG9wdGlvbnMgZm9yIHRoZSBjbGFzcy5cbiAgICovXG4gIGNvbnN0cnVjdG9yKGNyZWRzLCBvcHRpb25zKSB7XG4gICAgdGhpcy5jcmVkcyA9IGNyZWRzO1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSBTdHJlYW1Db250cm9sbGVyXG4gICAgICovXG4gICAgdGhpcy5zdHJlYW0gPSBuZXcgU3RyZWFtUmVzb3VyY2UodGhpcy5jcmVkcywgdGhpcy5vcHRpb25zKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIFRhbGtSZXNvdXJjZVxuICAgICAqL1xuICAgIHRoaXMudGFsayA9IG5ldyBUYWxrUmVzb3VyY2UodGhpcy5jcmVkcywgdGhpcy5vcHRpb25zKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIER0bWZSZXNvdXJjZVxuICAgICAqL1xuICAgIHRoaXMuZHRtZiA9IG5ldyBEdG1mUmVzb3VyY2UodGhpcy5jcmVkcywgdGhpcy5vcHRpb25zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgY2FsbC5cbiAgICpcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyAtIFBhcmFtZXRlcnMgdXNlZCB3aGVuIGNyZWF0aW5nIHRoZSBjYWxsLiBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubmV4bW8uY29tL2FwaS92b2ljZSNjcmVhdGUtYW4tb3V0Ym91bmQtY2FsbCBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hlbiB0aGUgcmVxdWVzdCBjb21wbGV0ZXMuXG4gICAqL1xuICBjcmVhdGUocGFyYW1zLCBjYWxsYmFjaykge1xuICAgIHBhcmFtcyA9IEpTT04uc3RyaW5naWZ5KHBhcmFtcyk7XG5cbiAgICB2YXIgY29uZmlnID0ge1xuICAgICAgaG9zdDogdGhpcy5vcHRpb25zLmFwaUhvc3QgfHwgXCJhcGkubmV4bW8uY29tXCIsXG4gICAgICBwYXRoOiBDYWxsc1Jlc291cmNlLlBBVEgsXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogcGFyYW1zLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgXCJDb250ZW50LUxlbmd0aFwiOiBCdWZmZXIuYnl0ZUxlbmd0aChwYXJhbXMpLFxuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5jcmVkcy5nZW5lcmF0ZUp3dCgpfWAsXG4gICAgICB9LFxuICAgIH07XG4gICAgdGhpcy5vcHRpb25zLmh0dHBDbGllbnQucmVxdWVzdChjb25maWcsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYW4gZXhpc3RpbmcgY2FsbC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd8b2JqZWN0fSBxdWVyeSAtIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIGNhbGwgdG8gcmV0cmlldmVcbiAgICogICAgICAgICAgICAgICBvciBhIHNldCBvZiBmaWx0ZXIgcGFyYW1ldGVycyBmb3IgdGhlIHF1ZXJ5LiBGb3IgbW9yZSBpbmZvcm1hdGlvblxuICAgKiAgICAgICAgICAgICAgIHNlZSBodHRwczovL2RvY3MubmV4bW8uY29tL3ZvaWNlL3ZvaWNlLWFwaS9hcGktcmVmZXJlbmNlI2NhbGxfcmV0cmlldmVcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hlbiB0aGUgcmVxdWVzdCBjb21wbGV0ZXMuXG4gICAqL1xuICBnZXQocXVlcnksIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFxdWVyeSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdcInF1ZXJ5XCIgaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTtcbiAgICB9XG5cbiAgICB2YXIgcGF0aEV4dCA9IFwiXCI7XG4gICAgaWYgKHR5cGVvZiBxdWVyeSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgLy8gc2luZ2xlIGNhbGwgSWRcbiAgICAgIHBhdGhFeHQgPSBgLyR7cXVlcnl9YDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBxdWVyeSA9PT0gXCJvYmplY3RcIiAmJiBPYmplY3Qua2V5cyhxdWVyeSkubGVuZ3RoID4gMCkge1xuICAgICAgLy8gZmlsdGVyXG4gICAgICBwYXRoRXh0ID0gYD8ke3F1ZXJ5c3RyaW5nLnN0cmluZ2lmeShxdWVyeSl9YDtcbiAgICB9XG5cbiAgICB2YXIgY29uZmlnID0ge1xuICAgICAgaG9zdDogdGhpcy5vcHRpb25zLmFwaUhvc3QgfHwgXCJhcGkubmV4bW8uY29tXCIsXG4gICAgICBwYXRoOiBgJHtDYWxsc1Jlc291cmNlLlBBVEh9JHtwYXRoRXh0fWAsXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5jcmVkcy5nZW5lcmF0ZUp3dCgpfWAsXG4gICAgICB9LFxuICAgIH07XG4gICAgdGhpcy5vcHRpb25zLmh0dHBDbGllbnQucmVxdWVzdChjb25maWcsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgYW4gZXhpc3RpbmcgY2FsbC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IFtjYWxsSWRdIC0gVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgY2FsbCB0byB1cGRhdGUuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXMgLSBQYXJhbWV0ZXJzIHVzZWQgd2hlbiB1cGRhdGluZyB0aGUgY2FsbC4gU2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm5leG1vLmNvbS9hcGkvdm9pY2UjbW9kaWZ5LWFuLWV4aXN0aW5nLWNhbGwgZm9yIG1vcmUgaW5mb3JtYXRpb24uXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gZnVuY3Rpb24gdG8gYmUgY2FsbGVkIHdoZW4gdGhlIHJlcXVlc3QgY29tcGxldGVzLlxuICAgKi9cbiAgdXBkYXRlKGNhbGxJZCwgcGFyYW1zLCBjYWxsYmFjaykge1xuICAgIHBhcmFtcyA9IEpTT04uc3RyaW5naWZ5KHBhcmFtcyk7XG5cbiAgICB2YXIgY29uZmlnID0ge1xuICAgICAgaG9zdDogdGhpcy5vcHRpb25zLmFwaUhvc3QgfHwgXCJhcGkubmV4bW8uY29tXCIsXG4gICAgICBwYXRoOiBgJHtDYWxsc1Jlc291cmNlLlBBVEh9LyR7Y2FsbElkfWAsXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBib2R5OiBwYXJhbXMsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBcIkNvbnRlbnQtTGVuZ3RoXCI6IEJ1ZmZlci5ieXRlTGVuZ3RoKHBhcmFtcyksXG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmNyZWRzLmdlbmVyYXRlSnd0KCl9YCxcbiAgICAgIH0sXG4gICAgfTtcbiAgICB0aGlzLm9wdGlvbnMuaHR0cENsaWVudC5yZXF1ZXN0KGNvbmZpZywgY2FsbGJhY2spO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhbGxzUmVzb3VyY2U7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFFQTs7QUFDQTs7QUFDQTs7OztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU1BLGFBQU4sQ0FBb0I7RUFDbEI7QUFDRjtBQUNBO0VBQ2lCLFdBQUpDLElBQUksR0FBRztJQUNoQixPQUFPLFdBQVA7RUFDRDtFQUVEO0FBQ0Y7QUFDQTtBQUNB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